import"./styles-CiyrG2OF.js";var R=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ut={exports:{}},j={exports:{}},Z={exports:{}};/*!
  * Bootstrap data.js v5.3.3 (https://getbootstrap.com/)
  * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var dt;function Wt(){return dt||(dt=1,function(e,t){(function(i,s){e.exports=s()})(R,function(){const i=new Map;return{set(r,n,a){i.has(r)||i.set(r,new Map);const h=i.get(r);if(!h.has(n)&&h.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(h.keys())[0]}.`);return}h.set(n,a)},get(r,n){return i.has(r)&&i.get(r).get(n)||null},remove(r,n){if(!i.has(r))return;const a=i.get(r);a.delete(n),a.size===0&&i.delete(r)}}})}(Z)),Z.exports}var H={exports:{}},Y={exports:{}};/*!
  * Bootstrap index.js v5.3.3 (https://getbootstrap.com/)
  * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var ut;function P(){return ut||(ut=1,function(e,t){(function(i,s){s(t)})(R,function(i){const n="transitionend",a=g=>(g&&window.CSS&&window.CSS.escape&&(g=g.replace(/#([^\s"#']+)/g,(A,b)=>`#${CSS.escape(b)}`)),g),h=g=>g==null?`${g}`:Object.prototype.toString.call(g).match(/\s([a-z]+)/i)[1].toLowerCase(),l=g=>{do g+=Math.floor(Math.random()*1e6);while(document.getElementById(g));return g},o=g=>{if(!g)return 0;let{transitionDuration:A,transitionDelay:b}=window.getComputedStyle(g);const D=Number.parseFloat(A),w=Number.parseFloat(b);return!D&&!w?0:(A=A.split(",")[0],b=b.split(",")[0],(Number.parseFloat(A)+Number.parseFloat(b))*1e3)},c=g=>{g.dispatchEvent(new Event(n))},u=g=>!g||typeof g!="object"?!1:(typeof g.jquery<"u"&&(g=g[0]),typeof g.nodeType<"u"),f=g=>u(g)?g.jquery?g[0]:g:typeof g=="string"&&g.length>0?document.querySelector(a(g)):null,d=g=>{if(!u(g)||g.getClientRects().length===0)return!1;const A=getComputedStyle(g).getPropertyValue("visibility")==="visible",b=g.closest("details:not([open])");if(!b)return A;if(b!==g){const D=g.closest("summary");if(D&&D.parentNode!==b||D===null)return!1}return A},p=g=>!g||g.nodeType!==Node.ELEMENT_NODE||g.classList.contains("disabled")?!0:typeof g.disabled<"u"?g.disabled:g.hasAttribute("disabled")&&g.getAttribute("disabled")!=="false",_=g=>{if(!document.documentElement.attachShadow)return null;if(typeof g.getRootNode=="function"){const A=g.getRootNode();return A instanceof ShadowRoot?A:null}return g instanceof ShadowRoot?g:g.parentNode?_(g.parentNode):null},y=()=>{},E=g=>{g.offsetHeight},O=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,M=[],S=g=>{document.readyState==="loading"?(M.length||document.addEventListener("DOMContentLoaded",()=>{for(const A of M)A()}),M.push(g)):g()},C=()=>document.documentElement.dir==="rtl",m=g=>{S(()=>{const A=O();if(A){const b=g.NAME,D=A.fn[b];A.fn[b]=g.jQueryInterface,A.fn[b].Constructor=g,A.fn[b].noConflict=()=>(A.fn[b]=D,g.jQueryInterface)}})},x=(g,A=[],b=g)=>typeof g=="function"?g(...A):b,v=(g,A,b=!0)=>{if(!b){x(g);return}const w=o(A)+5;let z=!1;const L=({target:$})=>{$===A&&(z=!0,A.removeEventListener(n,L),x(g))};A.addEventListener(n,L),setTimeout(()=>{z||c(A)},w)},T=(g,A,b,D)=>{const w=g.length;let z=g.indexOf(A);return z===-1?!b&&D?g[w-1]:g[0]:(z+=b?1:-1,D&&(z=(z+w)%w),g[Math.max(0,Math.min(z,w-1))])};i.defineJQueryPlugin=m,i.execute=x,i.executeAfterTransition=v,i.findShadowRoot=_,i.getElement=f,i.getNextActiveElement=T,i.getTransitionDurationFromElement=o,i.getUID=l,i.getjQuery=O,i.isDisabled=p,i.isElement=u,i.isRTL=C,i.isVisible=d,i.noop=y,i.onDOMContentLoaded=S,i.parseSelector=a,i.reflow=E,i.toType=h,i.triggerTransitionEnd=c,Object.defineProperty(i,Symbol.toStringTag,{value:"Module"})})}(Y,Y.exports)),Y.exports}/*!
  * Bootstrap event-handler.js v5.3.3 (https://getbootstrap.com/)
  * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var gt;function W(){return gt||(gt=1,function(e,t){(function(i,s){e.exports=s(P())})(R,function(i){const s=/[^.]*(?=\..*)\.|.*/,r=/\..*/,n=/::\d+$/,a={};let h=1;const l={mouseenter:"mouseover",mouseleave:"mouseout"},o=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function c(m,x){return x&&`${x}::${h++}`||m.uidEvent||h++}function u(m){const x=c(m);return m.uidEvent=x,a[x]=a[x]||{},a[x]}function f(m,x){return function v(T){return C(T,{delegateTarget:m}),v.oneOff&&S.off(m,T.type,x),x.apply(m,[T])}}function d(m,x,v){return function T(g){const A=m.querySelectorAll(x);for(let{target:b}=g;b&&b!==this;b=b.parentNode)for(const D of A)if(D===b)return C(g,{delegateTarget:b}),T.oneOff&&S.off(m,g.type,x,v),v.apply(b,[g])}}function p(m,x,v=null){return Object.values(m).find(T=>T.callable===x&&T.delegationSelector===v)}function _(m,x,v){const T=typeof x=="string",g=T?v:x||v;let A=M(m);return o.has(A)||(A=m),[T,g,A]}function y(m,x,v,T,g){if(typeof x!="string"||!m)return;let[A,b,D]=_(x,v,T);x in l&&(b=(Q=>function(N){if(!N.relatedTarget||N.relatedTarget!==N.delegateTarget&&!N.delegateTarget.contains(N.relatedTarget))return Q.call(this,N)})(b));const w=u(m),z=w[D]||(w[D]={}),L=p(z,b,A?v:null);if(L){L.oneOff=L.oneOff&&g;return}const $=c(b,x.replace(s,"")),I=A?d(m,v,b):f(m,b);I.delegationSelector=A?v:null,I.callable=b,I.oneOff=g,I.uidEvent=$,z[$]=I,m.addEventListener(D,I,A)}function E(m,x,v,T,g){const A=p(x[v],T,g);A&&(m.removeEventListener(v,A,!!g),delete x[v][A.uidEvent])}function O(m,x,v,T){const g=x[v]||{};for(const[A,b]of Object.entries(g))A.includes(T)&&E(m,x,v,b.callable,b.delegationSelector)}function M(m){return m=m.replace(r,""),l[m]||m}const S={on(m,x,v,T){y(m,x,v,T,!1)},one(m,x,v,T){y(m,x,v,T,!0)},off(m,x,v,T){if(typeof x!="string"||!m)return;const[g,A,b]=_(x,v,T),D=b!==x,w=u(m),z=w[b]||{},L=x.startsWith(".");if(typeof A<"u"){if(!Object.keys(z).length)return;E(m,w,b,A,g?v:null);return}if(L)for(const $ of Object.keys(w))O(m,w,$,x.slice(1));for(const[$,I]of Object.entries(z)){const q=$.replace(n,"");(!D||x.includes(q))&&E(m,w,b,I.callable,I.delegationSelector)}},trigger(m,x,v){if(typeof x!="string"||!m)return null;const T=i.getjQuery(),g=M(x),A=x!==g;let b=null,D=!0,w=!0,z=!1;A&&T&&(b=T.Event(x,v),T(m).trigger(b),D=!b.isPropagationStopped(),w=!b.isImmediatePropagationStopped(),z=b.isDefaultPrevented());const L=C(new Event(x,{bubbles:D,cancelable:!0}),v);return z&&L.preventDefault(),w&&m.dispatchEvent(L),L.defaultPrevented&&b&&b.preventDefault(),L}};function C(m,x={}){for(const[v,T]of Object.entries(x))try{m[v]=T}catch{Object.defineProperty(m,v,{configurable:!0,get(){return T}})}return m}return S})}(H)),H.exports}var J={exports:{}},tt={exports:{}};/*!
  * Bootstrap manipulator.js v5.3.3 (https://getbootstrap.com/)
  * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var pt;function Bt(){return pt||(pt=1,function(e,t){(function(i,s){e.exports=s()})(R,function(){function i(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function s(n){return n.replace(/[A-Z]/g,a=>`-${a.toLowerCase()}`)}return{setDataAttribute(n,a,h){n.setAttribute(`data-bs-${s(a)}`,h)},removeDataAttribute(n,a){n.removeAttribute(`data-bs-${s(a)}`)},getDataAttributes(n){if(!n)return{};const a={},h=Object.keys(n.dataset).filter(l=>l.startsWith("bs")&&!l.startsWith("bsConfig"));for(const l of h){let o=l.replace(/^bs/,"");o=o.charAt(0).toLowerCase()+o.slice(1,o.length),a[o]=i(n.dataset[l])}return a},getDataAttribute(n,a){return i(n.getAttribute(`data-bs-${s(a)}`))}}})}(tt)),tt.exports}/*!
  * Bootstrap config.js v5.3.3 (https://getbootstrap.com/)
  * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var mt;function ft(){return mt||(mt=1,function(e,t){(function(i,s){e.exports=s(Bt(),P())})(R,function(i,s){class r{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(a){return a=this._mergeConfigObj(a),a=this._configAfterMerge(a),this._typeCheckConfig(a),a}_configAfterMerge(a){return a}_mergeConfigObj(a,h){const l=s.isElement(h)?i.getDataAttribute(h,"config"):{};return{...this.constructor.Default,...typeof l=="object"?l:{},...s.isElement(h)?i.getDataAttributes(h):{},...typeof a=="object"?a:{}}}_typeCheckConfig(a,h=this.constructor.DefaultType){for(const[l,o]of Object.entries(h)){const c=a[l],u=s.isElement(c)?"element":s.toType(c);if(!new RegExp(o).test(u))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${l}" provided type "${u}" but expected type "${o}".`)}}}return r})}(J)),J.exports}/*!
  * Bootstrap base-component.js v5.3.3 (https://getbootstrap.com/)
  * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var _t;function Yt(){return _t||(_t=1,function(e,t){(function(i,s){e.exports=s(Wt(),W(),ft(),P())})(R,function(i,s,r,n){const a="5.3.3";class h extends r{constructor(o,c){super(),o=n.getElement(o),o&&(this._element=o,this._config=this._getConfig(c),i.set(this._element,this.constructor.DATA_KEY,this))}dispose(){i.remove(this._element,this.constructor.DATA_KEY),s.off(this._element,this.constructor.EVENT_KEY);for(const o of Object.getOwnPropertyNames(this))this[o]=null}_queueCallback(o,c,u=!0){n.executeAfterTransition(o,c,u)}_getConfig(o){return o=this._mergeConfigObj(o,this._element),o=this._configAfterMerge(o),this._typeCheckConfig(o),o}static getInstance(o){return i.get(n.getElement(o),this.DATA_KEY)}static getOrCreateInstance(o,c={}){return this.getInstance(o)||new this(o,typeof c=="object"?c:null)}static get VERSION(){return a}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(o){return`${o}${this.EVENT_KEY}`}}return h})}(j)),j.exports}var et={exports:{}};/*!
  * Bootstrap selector-engine.js v5.3.3 (https://getbootstrap.com/)
  * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var yt;function G(){return yt||(yt=1,function(e,t){(function(i,s){e.exports=s(P())})(R,function(i){const s=n=>{let a=n.getAttribute("data-bs-target");if(!a||a==="#"){let h=n.getAttribute("href");if(!h||!h.includes("#")&&!h.startsWith("."))return null;h.includes("#")&&!h.startsWith("#")&&(h=`#${h.split("#")[1]}`),a=h&&h!=="#"?h.trim():null}return a?a.split(",").map(h=>i.parseSelector(h)).join(","):null},r={find(n,a=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(a,n))},findOne(n,a=document.documentElement){return Element.prototype.querySelector.call(a,n)},children(n,a){return[].concat(...n.children).filter(h=>h.matches(a))},parents(n,a){const h=[];let l=n.parentNode.closest(a);for(;l;)h.push(l),l=l.parentNode.closest(a);return h},prev(n,a){let h=n.previousElementSibling;for(;h;){if(h.matches(a))return[h];h=h.previousElementSibling}return[]},next(n,a){let h=n.nextElementSibling;for(;h;){if(h.matches(a))return[h];h=h.nextElementSibling}return[]},focusableChildren(n){const a=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(h=>`${h}:not([tabindex^="-"])`).join(",");return this.find(a,n).filter(h=>!i.isDisabled(h)&&i.isVisible(h))},getSelectorFromElement(n){const a=s(n);return a&&r.findOne(a)?a:null},getElementFromSelector(n){const a=s(n);return a?r.findOne(a):null},getMultipleElementsFromSelector(n){const a=s(n);return a?r.find(a):[]}};return r})}(et)),et.exports}var it={exports:{}};/*!
  * Bootstrap backdrop.js v5.3.3 (https://getbootstrap.com/)
  * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var Et;function Xt(){return Et||(Et=1,function(e,t){(function(i,s){e.exports=s(W(),ft(),P())})(R,function(i,s,r){const n="backdrop",a="fade",h="show",l=`mousedown.bs.${n}`,o={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},c={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class u extends s{constructor(d){super(),this._config=this._getConfig(d),this._isAppended=!1,this._element=null}static get Default(){return o}static get DefaultType(){return c}static get NAME(){return n}show(d){if(!this._config.isVisible){r.execute(d);return}this._append();const p=this._getElement();this._config.isAnimated&&r.reflow(p),p.classList.add(h),this._emulateAnimation(()=>{r.execute(d)})}hide(d){if(!this._config.isVisible){r.execute(d);return}this._getElement().classList.remove(h),this._emulateAnimation(()=>{this.dispose(),r.execute(d)})}dispose(){this._isAppended&&(i.off(this._element,l),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const d=document.createElement("div");d.className=this._config.className,this._config.isAnimated&&d.classList.add(a),this._element=d}return this._element}_configAfterMerge(d){return d.rootElement=r.getElement(d.rootElement),d}_append(){if(this._isAppended)return;const d=this._getElement();this._config.rootElement.append(d),i.on(d,l,()=>{r.execute(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(d){r.executeAfterTransition(d,this._getElement(),this._config.isAnimated)}}return u})}(it)),it.exports}var X={exports:{}};/*!
  * Bootstrap component-functions.js v5.3.3 (https://getbootstrap.com/)
  * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var bt;function Kt(){return bt||(bt=1,function(e,t){(function(i,s){s(t,W(),G(),P())})(R,function(i,s,r,n){const a=(h,l="hide")=>{const o=`click.dismiss${h.EVENT_KEY}`,c=h.NAME;s.on(document,o,`[data-bs-dismiss="${c}"]`,function(u){if(["A","AREA"].includes(this.tagName)&&u.preventDefault(),n.isDisabled(this))return;const f=r.getElementFromSelector(this)||this.closest(`.${c}`);h.getOrCreateInstance(f)[l]()})};i.enableDismissTrigger=a,Object.defineProperty(i,Symbol.toStringTag,{value:"Module"})})}(X,X.exports)),X.exports}var st={exports:{}};/*!
  * Bootstrap focustrap.js v5.3.3 (https://getbootstrap.com/)
  * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var xt;function Gt(){return xt||(xt=1,function(e,t){(function(i,s){e.exports=s(W(),G(),ft())})(R,function(i,s,r){const n="focustrap",h=".bs.focustrap",l=`focusin${h}`,o=`keydown.tab${h}`,c="Tab",u="forward",f="backward",d={autofocus:!0,trapElement:null},p={autofocus:"boolean",trapElement:"element"};class _ extends r{constructor(E){super(),this._config=this._getConfig(E),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return d}static get DefaultType(){return p}static get NAME(){return n}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),i.off(document,h),i.on(document,l,E=>this._handleFocusin(E)),i.on(document,o,E=>this._handleKeydown(E)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,i.off(document,h))}_handleFocusin(E){const{trapElement:O}=this._config;if(E.target===document||E.target===O||O.contains(E.target))return;const M=s.focusableChildren(O);M.length===0?O.focus():this._lastTabNavDirection===f?M[M.length-1].focus():M[0].focus()}_handleKeydown(E){E.key===c&&(this._lastTabNavDirection=E.shiftKey?f:u)}}return _})}(st)),st.exports}var rt={exports:{}};/*!
  * Bootstrap scrollbar.js v5.3.3 (https://getbootstrap.com/)
  * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var At;function Qt(){return At||(At=1,function(e,t){(function(i,s){e.exports=s(Bt(),G(),P())})(R,function(i,s,r){const n=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",a=".sticky-top",h="padding-right",l="margin-right";class o{constructor(){this._element=document.body}getWidth(){const u=document.documentElement.clientWidth;return Math.abs(window.innerWidth-u)}hide(){const u=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,h,f=>f+u),this._setElementAttributes(n,h,f=>f+u),this._setElementAttributes(a,l,f=>f-u)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,h),this._resetElementAttributes(n,h),this._resetElementAttributes(a,l)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(u,f,d){const p=this.getWidth(),_=y=>{if(y!==this._element&&window.innerWidth>y.clientWidth+p)return;this._saveInitialAttribute(y,f);const E=window.getComputedStyle(y).getPropertyValue(f);y.style.setProperty(f,`${d(Number.parseFloat(E))}px`)};this._applyManipulationCallback(u,_)}_saveInitialAttribute(u,f){const d=u.style.getPropertyValue(f);d&&i.setDataAttribute(u,f,d)}_resetElementAttributes(u,f){const d=p=>{const _=i.getDataAttribute(p,f);if(_===null){p.style.removeProperty(f);return}i.removeDataAttribute(p,f),p.style.setProperty(f,_)};this._applyManipulationCallback(u,d)}_applyManipulationCallback(u,f){if(r.isElement(u)){f(u);return}for(const d of s.find(u,this._element))f(d)}}return o})}(rt)),rt.exports}/*!
  * Bootstrap modal.js v5.3.3 (https://getbootstrap.com/)
  * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */(function(e,t){(function(i,s){e.exports=s(Yt(),W(),G(),Xt(),Kt(),Gt(),P(),Qt())})(R,function(i,s,r,n,a,h,l,o){const c="modal",f=".bs.modal",d=".data-api",p="Escape",_=`hide${f}`,y=`hidePrevented${f}`,E=`hidden${f}`,O=`show${f}`,M=`shown${f}`,S=`resize${f}`,C=`click.dismiss${f}`,m=`mousedown.dismiss${f}`,x=`keydown.dismiss${f}`,v=`click${f}${d}`,T="modal-open",g="fade",A="show",b="modal-static",D=".modal.show",w=".modal-dialog",z=".modal-body",L='[data-bs-toggle="modal"]',$={backdrop:!0,focus:!0,keyboard:!0},I={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class q extends i{constructor(N,F){super(N,F),this._dialog=r.findOne(w,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new o,this._addEventListeners()}static get Default(){return $}static get DefaultType(){return I}static get NAME(){return c}toggle(N){return this._isShown?this.hide():this.show(N)}show(N){this._isShown||this._isTransitioning||s.trigger(this._element,O,{relatedTarget:N}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(T),this._adjustDialog(),this._backdrop.show(()=>this._showElement(N)))}hide(){!this._isShown||this._isTransitioning||s.trigger(this._element,_).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(A),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){s.off(window,f),s.off(this._dialog,f),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new n({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new h({trapElement:this._element})}_showElement(N){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const F=r.findOne(z,this._dialog);F&&(F.scrollTop=0),l.reflow(this._element),this._element.classList.add(A);const k=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,s.trigger(this._element,M,{relatedTarget:N})};this._queueCallback(k,this._dialog,this._isAnimated())}_addEventListeners(){s.on(this._element,x,N=>{if(N.key===p){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),s.on(window,S,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),s.on(this._element,m,N=>{s.one(this._element,C,F=>{if(!(this._element!==N.target||this._element!==F.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(T),this._resetAdjustments(),this._scrollBar.reset(),s.trigger(this._element,E)})}_isAnimated(){return this._element.classList.contains(g)}_triggerBackdropTransition(){if(s.trigger(this._element,y).defaultPrevented)return;const F=this._element.scrollHeight>document.documentElement.clientHeight,k=this._element.style.overflowY;k==="hidden"||this._element.classList.contains(b)||(F||(this._element.style.overflowY="hidden"),this._element.classList.add(b),this._queueCallback(()=>{this._element.classList.remove(b),this._queueCallback(()=>{this._element.style.overflowY=k},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const N=this._element.scrollHeight>document.documentElement.clientHeight,F=this._scrollBar.getWidth(),k=F>0;if(k&&!N){const V=l.isRTL()?"paddingLeft":"paddingRight";this._element.style[V]=`${F}px`}if(!k&&N){const V=l.isRTL()?"paddingRight":"paddingLeft";this._element.style[V]=`${F}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(N,F){return this.each(function(){const k=q.getOrCreateInstance(this,N);if(typeof N=="string"){if(typeof k[N]>"u")throw new TypeError(`No method named "${N}"`);k[N](F)}})}}return s.on(document,v,L,function(Q){const N=r.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&Q.preventDefault(),s.one(N,O,V=>{V.defaultPrevented||s.one(N,E,()=>{l.isVisible(this)&&this.focus()})});const F=r.findOne(D);F&&q.getInstance(F).hide(),q.getOrCreateInstance(N).toggle(this)}),a.enableDismissTrigger(q),l.defineJQueryPlugin(q),q})})(Ut);function U(e){let t=e[0],i=e[1],s=e[2];return Math.sqrt(t*t+i*i+s*s)}function ot(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function jt(e,t,i,s){return e[0]=t,e[1]=i,e[2]=s,e}function wt(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e}function Mt(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e}function Zt(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e}function Ht(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e[2]=t[2]/i[2],e}function nt(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e}function Jt(e,t){let i=t[0]-e[0],s=t[1]-e[1],r=t[2]-e[2];return Math.sqrt(i*i+s*s+r*r)}function te(e,t){let i=t[0]-e[0],s=t[1]-e[1],r=t[2]-e[2];return i*i+s*s+r*r}function vt(e){let t=e[0],i=e[1],s=e[2];return t*t+i*i+s*s}function ee(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function ie(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function ct(e,t){let i=t[0],s=t[1],r=t[2],n=i*i+s*s+r*r;return n>0&&(n=1/Math.sqrt(n)),e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}function $t(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Tt(e,t,i){let s=t[0],r=t[1],n=t[2],a=i[0],h=i[1],l=i[2];return e[0]=r*l-n*h,e[1]=n*a-s*l,e[2]=s*h-r*a,e}function se(e,t,i,s){let r=t[0],n=t[1],a=t[2];return e[0]=r+s*(i[0]-r),e[1]=n+s*(i[1]-n),e[2]=a+s*(i[2]-a),e}function re(e,t,i){let s=t[0],r=t[1],n=t[2],a=i[3]*s+i[7]*r+i[11]*n+i[15];return a=a||1,e[0]=(i[0]*s+i[4]*r+i[8]*n+i[12])/a,e[1]=(i[1]*s+i[5]*r+i[9]*n+i[13])/a,e[2]=(i[2]*s+i[6]*r+i[10]*n+i[14])/a,e}function ne(e,t,i){let s=t[0],r=t[1],n=t[2],a=i[3]*s+i[7]*r+i[11]*n+i[15];return a=a||1,e[0]=(i[0]*s+i[4]*r+i[8]*n)/a,e[1]=(i[1]*s+i[5]*r+i[9]*n)/a,e[2]=(i[2]*s+i[6]*r+i[10]*n)/a,e}function ae(e,t,i){let s=t[0],r=t[1],n=t[2];return e[0]=s*i[0]+r*i[3]+n*i[6],e[1]=s*i[1]+r*i[4]+n*i[7],e[2]=s*i[2]+r*i[5]+n*i[8],e}function he(e,t,i){let s=t[0],r=t[1],n=t[2],a=i[0],h=i[1],l=i[2],o=i[3],c=h*n-l*r,u=l*s-a*n,f=a*r-h*s,d=h*f-l*u,p=l*c-a*f,_=a*u-h*c,y=o*2;return c*=y,u*=y,f*=y,d*=2,p*=2,_*=2,e[0]=s+c+d,e[1]=r+u+p,e[2]=n+f+_,e}const le=function(){const e=[0,0,0],t=[0,0,0];return function(i,s){ot(e,i),ot(t,s),ct(e,e),ct(t,t);let r=$t(e,t);return r>1?0:r<-1?Math.PI:Math.acos(r)}}();function oe(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}class B extends Array{constructor(t=0,i=t,s=t){return super(t,i,s),this}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}set x(t){this[0]=t}set y(t){this[1]=t}set z(t){this[2]=t}set(t,i=t,s=t){return t.length?this.copy(t):(jt(this,t,i,s),this)}copy(t){return ot(this,t),this}add(t,i){return i?wt(this,t,i):wt(this,this,t),this}sub(t,i){return i?Mt(this,t,i):Mt(this,this,t),this}multiply(t){return t.length?Zt(this,this,t):nt(this,this,t),this}divide(t){return t.length?Ht(this,this,t):nt(this,this,1/t),this}inverse(t=this){return ie(this,t),this}len(){return U(this)}distance(t){return t?Jt(this,t):U(this)}squaredLen(){return vt(this)}squaredDistance(t){return t?te(this,t):vt(this)}negate(t=this){return ee(this,t),this}cross(t,i){return i?Tt(this,t,i):Tt(this,this,t),this}scale(t){return nt(this,this,t),this}normalize(){return ct(this,this),this}dot(t){return $t(this,t)}equals(t){return oe(this,t)}applyMatrix3(t){return ae(this,this,t),this}applyMatrix4(t){return re(this,this,t),this}scaleRotateMatrix4(t){return ne(this,this,t),this}applyQuaternion(t){return he(this,this,t),this}angle(t){return le(this,t)}lerp(t,i){return se(this,this,t,i),this}clone(){return new B(this[0],this[1],this[2])}fromArray(t,i=0){return this[0]=t[i],this[1]=t[i+1],this[2]=t[i+2],this}toArray(t=[],i=0){return t[i]=this[0],t[i+1]=this[1],t[i+2]=this[2],t}transformDirection(t){const i=this[0],s=this[1],r=this[2];return this[0]=t[0]*i+t[4]*s+t[8]*r,this[1]=t[1]*i+t[5]*s+t[9]*r,this[2]=t[2]*i+t[6]*s+t[10]*r,this.normalize()}}const St=new B;let ce=1,fe=1,Ct=!1;class de{constructor(t,i={}){t.canvas||console.error("gl not passed as first argument to Geometry"),this.gl=t,this.attributes=i,this.id=ce++,this.VAOs={},this.drawRange={start:0,count:0},this.instancedCount=0,this.gl.renderer.bindVertexArray(null),this.gl.renderer.currentGeometry=null,this.glState=this.gl.renderer.state;for(let s in i)this.addAttribute(s,i[s])}addAttribute(t,i){if(this.attributes[t]=i,i.id=fe++,i.size=i.size||1,i.type=i.type||(i.data.constructor===Float32Array?this.gl.FLOAT:i.data.constructor===Uint16Array?this.gl.UNSIGNED_SHORT:this.gl.UNSIGNED_INT),i.target=t==="index"?this.gl.ELEMENT_ARRAY_BUFFER:this.gl.ARRAY_BUFFER,i.normalized=i.normalized||!1,i.stride=i.stride||0,i.offset=i.offset||0,i.count=i.count||(i.stride?i.data.byteLength/i.stride:i.data.length/i.size),i.divisor=i.instanced||0,i.needsUpdate=!1,i.usage=i.usage||this.gl.STATIC_DRAW,i.buffer||this.updateAttribute(i),i.divisor){if(this.isInstanced=!0,this.instancedCount&&this.instancedCount!==i.count*i.divisor)return console.warn("geometry has multiple instanced buffers of different length"),this.instancedCount=Math.min(this.instancedCount,i.count*i.divisor);this.instancedCount=i.count*i.divisor}else t==="index"?this.drawRange.count=i.count:this.attributes.index||(this.drawRange.count=Math.max(this.drawRange.count,i.count))}updateAttribute(t){const i=!t.buffer;i&&(t.buffer=this.gl.createBuffer()),this.glState.boundBuffer!==t.buffer&&(this.gl.bindBuffer(t.target,t.buffer),this.glState.boundBuffer=t.buffer),i?this.gl.bufferData(t.target,t.data,t.usage):this.gl.bufferSubData(t.target,0,t.data),t.needsUpdate=!1}setIndex(t){this.addAttribute("index",t)}setDrawRange(t,i){this.drawRange.start=t,this.drawRange.count=i}setInstancedCount(t){this.instancedCount=t}createVAO(t){this.VAOs[t.attributeOrder]=this.gl.renderer.createVertexArray(),this.gl.renderer.bindVertexArray(this.VAOs[t.attributeOrder]),this.bindAttributes(t)}bindAttributes(t){t.attributeLocations.forEach((i,{name:s,type:r})=>{if(!this.attributes[s]){console.warn(`active attribute ${s} not being supplied`);return}const n=this.attributes[s];this.gl.bindBuffer(n.target,n.buffer),this.glState.boundBuffer=n.buffer;let a=1;r===35674&&(a=2),r===35675&&(a=3),r===35676&&(a=4);const h=n.size/a,l=a===1?0:a*a*4,o=a===1?0:a*4;for(let c=0;c<a;c++)this.gl.vertexAttribPointer(i+c,h,n.type,n.normalized,n.stride+l,n.offset+c*o),this.gl.enableVertexAttribArray(i+c),this.gl.renderer.vertexAttribDivisor(i+c,n.divisor)}),this.attributes.index&&this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.attributes.index.buffer)}draw({program:t,mode:i=this.gl.TRIANGLES}){var r;this.gl.renderer.currentGeometry!==`${this.id}_${t.attributeOrder}`&&(this.VAOs[t.attributeOrder]||this.createVAO(t),this.gl.renderer.bindVertexArray(this.VAOs[t.attributeOrder]),this.gl.renderer.currentGeometry=`${this.id}_${t.attributeOrder}`),t.attributeLocations.forEach((n,{name:a})=>{const h=this.attributes[a];h.needsUpdate&&this.updateAttribute(h)});let s=2;((r=this.attributes.index)==null?void 0:r.type)===this.gl.UNSIGNED_INT&&(s=4),this.isInstanced?this.attributes.index?this.gl.renderer.drawElementsInstanced(i,this.drawRange.count,this.attributes.index.type,this.attributes.index.offset+this.drawRange.start*s,this.instancedCount):this.gl.renderer.drawArraysInstanced(i,this.drawRange.start,this.drawRange.count,this.instancedCount):this.attributes.index?this.gl.drawElements(i,this.drawRange.count,this.attributes.index.type,this.attributes.index.offset+this.drawRange.start*s):this.gl.drawArrays(i,this.drawRange.start,this.drawRange.count)}getPosition(){const t=this.attributes.position;if(t.data)return t;if(!Ct)return console.warn("No position buffer data found to compute bounds"),Ct=!0}computeBoundingBox(t){t||(t=this.getPosition());const i=t.data,s=t.size;this.bounds||(this.bounds={min:new B,max:new B,center:new B,scale:new B,radius:1/0});const r=this.bounds.min,n=this.bounds.max,a=this.bounds.center,h=this.bounds.scale;r.set(1/0),n.set(-1/0);for(let l=0,o=i.length;l<o;l+=s){const c=i[l],u=i[l+1],f=i[l+2];r.x=Math.min(c,r.x),r.y=Math.min(u,r.y),r.z=Math.min(f,r.z),n.x=Math.max(c,n.x),n.y=Math.max(u,n.y),n.z=Math.max(f,n.z)}h.sub(n,r),a.add(r,n).divide(2)}computeBoundingSphere(t){t||(t=this.getPosition());const i=t.data,s=t.size;this.bounds||this.computeBoundingBox(t);let r=0;for(let n=0,a=i.length;n<a;n+=s)St.fromArray(i,n),r=Math.max(r,this.bounds.center.squaredDistance(St));this.bounds.radius=Math.sqrt(r)}remove(){for(let t in this.VAOs)this.gl.renderer.deleteVertexArray(this.VAOs[t]),delete this.VAOs[t];for(let t in this.attributes)this.gl.deleteBuffer(this.attributes[t].buffer),delete this.attributes[t]}}let ue=1;const Dt={};class ge{constructor(t,{vertex:i,fragment:s,uniforms:r={},transparent:n=!1,cullFace:a=t.BACK,frontFace:h=t.CCW,depthTest:l=!0,depthWrite:o=!0,depthFunc:c=t.LEQUAL}={}){t.canvas||console.error("gl not passed as first argument to Program"),this.gl=t,this.uniforms=r,this.id=ue++,i||console.warn("vertex shader not supplied"),s||console.warn("fragment shader not supplied"),this.transparent=n,this.cullFace=a,this.frontFace=h,this.depthTest=l,this.depthWrite=o,this.depthFunc=c,this.blendFunc={},this.blendEquation={},this.transparent&&!this.blendFunc.src&&(this.gl.renderer.premultipliedAlpha?this.setBlendFunc(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA):this.setBlendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA)),this.vertexShader=t.createShader(t.VERTEX_SHADER),this.fragmentShader=t.createShader(t.FRAGMENT_SHADER),this.program=t.createProgram(),t.attachShader(this.program,this.vertexShader),t.attachShader(this.program,this.fragmentShader),this.setShaders({vertex:i,fragment:s})}setShaders({vertex:t,fragment:i}){if(t&&(this.gl.shaderSource(this.vertexShader,t),this.gl.compileShader(this.vertexShader),this.gl.getShaderInfoLog(this.vertexShader)!==""&&console.warn(`${this.gl.getShaderInfoLog(this.vertexShader)}
Vertex Shader
${Ot(t)}`)),i&&(this.gl.shaderSource(this.fragmentShader,i),this.gl.compileShader(this.fragmentShader),this.gl.getShaderInfoLog(this.fragmentShader)!==""&&console.warn(`${this.gl.getShaderInfoLog(this.fragmentShader)}
Fragment Shader
${Ot(i)}`)),this.gl.linkProgram(this.program),!this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS))return console.warn(this.gl.getProgramInfoLog(this.program));this.uniformLocations=new Map;let s=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_UNIFORMS);for(let a=0;a<s;a++){let h=this.gl.getActiveUniform(this.program,a);this.uniformLocations.set(h,this.gl.getUniformLocation(this.program,h.name));const l=h.name.match(/(\w+)/g);h.uniformName=l[0],h.nameComponents=l.slice(1)}this.attributeLocations=new Map;const r=[],n=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES);for(let a=0;a<n;a++){const h=this.gl.getActiveAttrib(this.program,a),l=this.gl.getAttribLocation(this.program,h.name);l!==-1&&(r[l]=h.name,this.attributeLocations.set(h,l))}this.attributeOrder=r.join("")}setBlendFunc(t,i,s,r){this.blendFunc.src=t,this.blendFunc.dst=i,this.blendFunc.srcAlpha=s,this.blendFunc.dstAlpha=r,t&&(this.transparent=!0)}setBlendEquation(t,i){this.blendEquation.modeRGB=t,this.blendEquation.modeAlpha=i}applyState(){this.depthTest?this.gl.renderer.enable(this.gl.DEPTH_TEST):this.gl.renderer.disable(this.gl.DEPTH_TEST),this.cullFace?this.gl.renderer.enable(this.gl.CULL_FACE):this.gl.renderer.disable(this.gl.CULL_FACE),this.blendFunc.src?this.gl.renderer.enable(this.gl.BLEND):this.gl.renderer.disable(this.gl.BLEND),this.cullFace&&this.gl.renderer.setCullFace(this.cullFace),this.gl.renderer.setFrontFace(this.frontFace),this.gl.renderer.setDepthMask(this.depthWrite),this.gl.renderer.setDepthFunc(this.depthFunc),this.blendFunc.src&&this.gl.renderer.setBlendFunc(this.blendFunc.src,this.blendFunc.dst,this.blendFunc.srcAlpha,this.blendFunc.dstAlpha),this.gl.renderer.setBlendEquation(this.blendEquation.modeRGB,this.blendEquation.modeAlpha)}use({flipFaces:t=!1}={}){let i=-1;this.gl.renderer.state.currentProgram===this.id||(this.gl.useProgram(this.program),this.gl.renderer.state.currentProgram=this.id),this.uniformLocations.forEach((r,n)=>{let a=this.uniforms[n.uniformName];for(const h of n.nameComponents){if(!a)break;if(h in a)a=a[h];else{if(Array.isArray(a.value))break;a=void 0;break}}if(!a)return Nt(`Active uniform ${n.name} has not been supplied`);if(a&&a.value===void 0)return Nt(`${n.name} uniform is missing a value parameter`);if(a.value.texture)return i=i+1,a.value.update(i),at(this.gl,n.type,r,i);if(a.value.length&&a.value[0].texture){const h=[];return a.value.forEach(l=>{i=i+1,l.update(i),h.push(i)}),at(this.gl,n.type,r,h)}at(this.gl,n.type,r,a.value)}),this.applyState(),t&&this.gl.renderer.setFrontFace(this.frontFace===this.gl.CCW?this.gl.CW:this.gl.CCW)}remove(){this.gl.deleteProgram(this.program)}}function at(e,t,i,s){s=s.length?pe(s):s;const r=e.renderer.state.uniformLocations.get(i);if(s.length)if(r===void 0||r.length!==s.length)e.renderer.state.uniformLocations.set(i,s.slice(0));else{if(me(r,s))return;r.set?r.set(s):_e(r,s),e.renderer.state.uniformLocations.set(i,r)}else{if(r===s)return;e.renderer.state.uniformLocations.set(i,s)}switch(t){case 5126:return s.length?e.uniform1fv(i,s):e.uniform1f(i,s);case 35664:return e.uniform2fv(i,s);case 35665:return e.uniform3fv(i,s);case 35666:return e.uniform4fv(i,s);case 35670:case 5124:case 35678:case 36306:case 35680:return s.length?e.uniform1iv(i,s):e.uniform1i(i,s);case 35671:case 35667:return e.uniform2iv(i,s);case 35672:case 35668:return e.uniform3iv(i,s);case 35673:case 35669:return e.uniform4iv(i,s);case 35674:return e.uniformMatrix2fv(i,!1,s);case 35675:return e.uniformMatrix3fv(i,!1,s);case 35676:return e.uniformMatrix4fv(i,!1,s)}}function Ot(e){let t=e.split(`
`);for(let i=0;i<t.length;i++)t[i]=i+1+": "+t[i];return t.join(`
`)}function pe(e){const t=e.length,i=e[0].length;if(i===void 0)return e;const s=t*i;let r=Dt[s];r||(Dt[s]=r=new Float32Array(s));for(let n=0;n<t;n++)r.set(e[n],n*i);return r}function me(e,t){if(e.length!==t.length)return!1;for(let i=0,s=e.length;i<s;i++)if(e[i]!==t[i])return!1;return!0}function _e(e,t){for(let i=0,s=e.length;i<s;i++)e[i]=t[i]}let ht=0;function Nt(e){ht>100||(console.warn(e),ht++,ht>100&&console.warn("More than 100 program warnings - stopping logs."))}const lt=new B;let ye=1;class Ee{constructor({canvas:t=document.createElement("canvas"),width:i=300,height:s=150,dpr:r=1,alpha:n=!1,depth:a=!0,stencil:h=!1,antialias:l=!1,premultipliedAlpha:o=!1,preserveDrawingBuffer:c=!1,powerPreference:u="default",autoClear:f=!0,webgl:d=2}={}){const p={alpha:n,depth:a,stencil:h,antialias:l,premultipliedAlpha:o,preserveDrawingBuffer:c,powerPreference:u};this.dpr=r,this.alpha=n,this.color=!0,this.depth=a,this.stencil=h,this.premultipliedAlpha=o,this.autoClear=f,this.id=ye++,d===2&&(this.gl=t.getContext("webgl2",p)),this.isWebgl2=!!this.gl,this.gl||(this.gl=t.getContext("webgl",p)),this.gl||console.error("unable to create webgl context"),this.gl.renderer=this,this.setSize(i,s),this.state={},this.state.blendFunc={src:this.gl.ONE,dst:this.gl.ZERO},this.state.blendEquation={modeRGB:this.gl.FUNC_ADD},this.state.cullFace=!1,this.state.frontFace=this.gl.CCW,this.state.depthMask=!0,this.state.depthFunc=this.gl.LEQUAL,this.state.premultiplyAlpha=!1,this.state.flipY=!1,this.state.unpackAlignment=4,this.state.framebuffer=null,this.state.viewport={x:0,y:0,width:null,height:null},this.state.textureUnits=[],this.state.activeTextureUnit=0,this.state.boundBuffer=null,this.state.uniformLocations=new Map,this.state.currentProgram=null,this.extensions={},this.isWebgl2?(this.getExtension("EXT_color_buffer_float"),this.getExtension("OES_texture_float_linear")):(this.getExtension("OES_texture_float"),this.getExtension("OES_texture_float_linear"),this.getExtension("OES_texture_half_float"),this.getExtension("OES_texture_half_float_linear"),this.getExtension("OES_element_index_uint"),this.getExtension("OES_standard_derivatives"),this.getExtension("EXT_sRGB"),this.getExtension("WEBGL_depth_texture"),this.getExtension("WEBGL_draw_buffers")),this.getExtension("WEBGL_compressed_texture_astc"),this.getExtension("EXT_texture_compression_bptc"),this.getExtension("WEBGL_compressed_texture_s3tc"),this.getExtension("WEBGL_compressed_texture_etc1"),this.getExtension("WEBGL_compressed_texture_pvrtc"),this.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),this.vertexAttribDivisor=this.getExtension("ANGLE_instanced_arrays","vertexAttribDivisor","vertexAttribDivisorANGLE"),this.drawArraysInstanced=this.getExtension("ANGLE_instanced_arrays","drawArraysInstanced","drawArraysInstancedANGLE"),this.drawElementsInstanced=this.getExtension("ANGLE_instanced_arrays","drawElementsInstanced","drawElementsInstancedANGLE"),this.createVertexArray=this.getExtension("OES_vertex_array_object","createVertexArray","createVertexArrayOES"),this.bindVertexArray=this.getExtension("OES_vertex_array_object","bindVertexArray","bindVertexArrayOES"),this.deleteVertexArray=this.getExtension("OES_vertex_array_object","deleteVertexArray","deleteVertexArrayOES"),this.drawBuffers=this.getExtension("WEBGL_draw_buffers","drawBuffers","drawBuffersWEBGL"),this.parameters={},this.parameters.maxTextureUnits=this.gl.getParameter(this.gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS),this.parameters.maxAnisotropy=this.getExtension("EXT_texture_filter_anisotropic")?this.gl.getParameter(this.getExtension("EXT_texture_filter_anisotropic").MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}setSize(t,i){this.width=t,this.height=i,this.gl.canvas.width=t*this.dpr,this.gl.canvas.height=i*this.dpr,this.gl.canvas.style&&Object.assign(this.gl.canvas.style,{width:t+"px",height:i+"px"})}setViewport(t,i,s=0,r=0){this.state.viewport.width===t&&this.state.viewport.height===i||(this.state.viewport.width=t,this.state.viewport.height=i,this.state.viewport.x=s,this.state.viewport.y=r,this.gl.viewport(s,r,t,i))}setScissor(t,i,s=0,r=0){this.gl.scissor(s,r,t,i)}enable(t){this.state[t]!==!0&&(this.gl.enable(t),this.state[t]=!0)}disable(t){this.state[t]!==!1&&(this.gl.disable(t),this.state[t]=!1)}setBlendFunc(t,i,s,r){this.state.blendFunc.src===t&&this.state.blendFunc.dst===i&&this.state.blendFunc.srcAlpha===s&&this.state.blendFunc.dstAlpha===r||(this.state.blendFunc.src=t,this.state.blendFunc.dst=i,this.state.blendFunc.srcAlpha=s,this.state.blendFunc.dstAlpha=r,s!==void 0?this.gl.blendFuncSeparate(t,i,s,r):this.gl.blendFunc(t,i))}setBlendEquation(t,i){t=t||this.gl.FUNC_ADD,!(this.state.blendEquation.modeRGB===t&&this.state.blendEquation.modeAlpha===i)&&(this.state.blendEquation.modeRGB=t,this.state.blendEquation.modeAlpha=i,i!==void 0?this.gl.blendEquationSeparate(t,i):this.gl.blendEquation(t))}setCullFace(t){this.state.cullFace!==t&&(this.state.cullFace=t,this.gl.cullFace(t))}setFrontFace(t){this.state.frontFace!==t&&(this.state.frontFace=t,this.gl.frontFace(t))}setDepthMask(t){this.state.depthMask!==t&&(this.state.depthMask=t,this.gl.depthMask(t))}setDepthFunc(t){this.state.depthFunc!==t&&(this.state.depthFunc=t,this.gl.depthFunc(t))}activeTexture(t){this.state.activeTextureUnit!==t&&(this.state.activeTextureUnit=t,this.gl.activeTexture(this.gl.TEXTURE0+t))}bindFramebuffer({target:t=this.gl.FRAMEBUFFER,buffer:i=null}={}){this.state.framebuffer!==i&&(this.state.framebuffer=i,this.gl.bindFramebuffer(t,i))}getExtension(t,i,s){return i&&this.gl[i]?this.gl[i].bind(this.gl):(this.extensions[t]||(this.extensions[t]=this.gl.getExtension(t)),i?this.extensions[t]?this.extensions[t][s].bind(this.extensions[t]):null:this.extensions[t])}sortOpaque(t,i){return t.renderOrder!==i.renderOrder?t.renderOrder-i.renderOrder:t.program.id!==i.program.id?t.program.id-i.program.id:t.zDepth!==i.zDepth?t.zDepth-i.zDepth:i.id-t.id}sortTransparent(t,i){return t.renderOrder!==i.renderOrder?t.renderOrder-i.renderOrder:t.zDepth!==i.zDepth?i.zDepth-t.zDepth:i.id-t.id}sortUI(t,i){return t.renderOrder!==i.renderOrder?t.renderOrder-i.renderOrder:t.program.id!==i.program.id?t.program.id-i.program.id:i.id-t.id}getRenderList({scene:t,camera:i,frustumCull:s,sort:r}){let n=[];if(i&&s&&i.updateFrustum(),t.traverse(a=>{if(!a.visible)return!0;a.draw&&(s&&a.frustumCulled&&i&&!i.frustumIntersectsMesh(a)||n.push(a))}),r){const a=[],h=[],l=[];n.forEach(o=>{o.program.transparent?o.program.depthTest?h.push(o):l.push(o):a.push(o),o.zDepth=0,!(o.renderOrder!==0||!o.program.depthTest||!i)&&(o.worldMatrix.getTranslation(lt),lt.applyMatrix4(i.projectionViewMatrix),o.zDepth=lt.z)}),a.sort(this.sortOpaque),h.sort(this.sortTransparent),l.sort(this.sortUI),n=a.concat(h,l)}return n}render({scene:t,camera:i,target:s=null,update:r=!0,sort:n=!0,frustumCull:a=!0,clear:h}){s===null?(this.bindFramebuffer(),this.setViewport(this.width*this.dpr,this.height*this.dpr)):(this.bindFramebuffer(s),this.setViewport(s.width,s.height)),(h||this.autoClear&&h!==!1)&&(this.depth&&(!s||s.depth)&&(this.enable(this.gl.DEPTH_TEST),this.setDepthMask(!0)),this.gl.clear((this.color?this.gl.COLOR_BUFFER_BIT:0)|(this.depth?this.gl.DEPTH_BUFFER_BIT:0)|(this.stencil?this.gl.STENCIL_BUFFER_BIT:0))),r&&t.updateMatrixWorld(),i&&i.updateMatrixWorld(),this.getRenderList({scene:t,camera:i,frustumCull:a,sort:n}).forEach(o=>{o.draw({camera:i})})}}function be(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function xe(e,t,i,s,r){return e[0]=t,e[1]=i,e[2]=s,e[3]=r,e}function Ae(e,t){let i=t[0],s=t[1],r=t[2],n=t[3],a=i*i+s*s+r*r+n*n;return a>0&&(a=1/Math.sqrt(a)),e[0]=i*a,e[1]=s*a,e[2]=r*a,e[3]=n*a,e}function we(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function Me(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function ve(e,t,i){i=i*.5;let s=Math.sin(i);return e[0]=s*t[0],e[1]=s*t[1],e[2]=s*t[2],e[3]=Math.cos(i),e}function zt(e,t,i){let s=t[0],r=t[1],n=t[2],a=t[3],h=i[0],l=i[1],o=i[2],c=i[3];return e[0]=s*c+a*h+r*o-n*l,e[1]=r*c+a*l+n*h-s*o,e[2]=n*c+a*o+s*l-r*h,e[3]=a*c-s*h-r*l-n*o,e}function Te(e,t,i){i*=.5;let s=t[0],r=t[1],n=t[2],a=t[3],h=Math.sin(i),l=Math.cos(i);return e[0]=s*l+a*h,e[1]=r*l+n*h,e[2]=n*l-r*h,e[3]=a*l-s*h,e}function Se(e,t,i){i*=.5;let s=t[0],r=t[1],n=t[2],a=t[3],h=Math.sin(i),l=Math.cos(i);return e[0]=s*l-n*h,e[1]=r*l+a*h,e[2]=n*l+s*h,e[3]=a*l-r*h,e}function Ce(e,t,i){i*=.5;let s=t[0],r=t[1],n=t[2],a=t[3],h=Math.sin(i),l=Math.cos(i);return e[0]=s*l+r*h,e[1]=r*l-s*h,e[2]=n*l+a*h,e[3]=a*l-n*h,e}function De(e,t,i,s){let r=t[0],n=t[1],a=t[2],h=t[3],l=i[0],o=i[1],c=i[2],u=i[3],f,d,p,_,y;return d=r*l+n*o+a*c+h*u,d<0&&(d=-d,l=-l,o=-o,c=-c,u=-u),1-d>1e-6?(f=Math.acos(d),p=Math.sin(f),_=Math.sin((1-s)*f)/p,y=Math.sin(s*f)/p):(_=1-s,y=s),e[0]=_*r+y*l,e[1]=_*n+y*o,e[2]=_*a+y*c,e[3]=_*h+y*u,e}function Oe(e,t){let i=t[0],s=t[1],r=t[2],n=t[3],a=i*i+s*s+r*r+n*n,h=a?1/a:0;return e[0]=-i*h,e[1]=-s*h,e[2]=-r*h,e[3]=n*h,e}function Ne(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function ze(e,t){let i=t[0]+t[4]+t[8],s;if(i>0)s=Math.sqrt(i+1),e[3]=.5*s,s=.5/s,e[0]=(t[5]-t[7])*s,e[1]=(t[6]-t[2])*s,e[2]=(t[1]-t[3])*s;else{let r=0;t[4]>t[0]&&(r=1),t[8]>t[r*3+r]&&(r=2);let n=(r+1)%3,a=(r+2)%3;s=Math.sqrt(t[r*3+r]-t[n*3+n]-t[a*3+a]+1),e[r]=.5*s,s=.5/s,e[3]=(t[n*3+a]-t[a*3+n])*s,e[n]=(t[n*3+r]+t[r*3+n])*s,e[a]=(t[a*3+r]+t[r*3+a])*s}return e}function Fe(e,t,i="YXZ"){let s=Math.sin(t[0]*.5),r=Math.cos(t[0]*.5),n=Math.sin(t[1]*.5),a=Math.cos(t[1]*.5),h=Math.sin(t[2]*.5),l=Math.cos(t[2]*.5);return i==="XYZ"?(e[0]=s*a*l+r*n*h,e[1]=r*n*l-s*a*h,e[2]=r*a*h+s*n*l,e[3]=r*a*l-s*n*h):i==="YXZ"?(e[0]=s*a*l+r*n*h,e[1]=r*n*l-s*a*h,e[2]=r*a*h-s*n*l,e[3]=r*a*l+s*n*h):i==="ZXY"?(e[0]=s*a*l-r*n*h,e[1]=r*n*l+s*a*h,e[2]=r*a*h+s*n*l,e[3]=r*a*l-s*n*h):i==="ZYX"?(e[0]=s*a*l-r*n*h,e[1]=r*n*l+s*a*h,e[2]=r*a*h-s*n*l,e[3]=r*a*l+s*n*h):i==="YZX"?(e[0]=s*a*l+r*n*h,e[1]=r*n*l+s*a*h,e[2]=r*a*h-s*n*l,e[3]=r*a*l-s*n*h):i==="XZY"&&(e[0]=s*a*l-r*n*h,e[1]=r*n*l-s*a*h,e[2]=r*a*h+s*n*l,e[3]=r*a*l+s*n*h),e}const Le=be,Re=xe,Ie=we,ke=Ae;class Be extends Array{constructor(t=0,i=0,s=0,r=1){super(t,i,s,r),this.onChange=()=>{},this._target=this;const n=["0","1","2","3"];return new Proxy(this,{set(a,h){const l=Reflect.set(...arguments);return l&&n.includes(h)&&a.onChange(),l}})}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}get w(){return this[3]}set x(t){this._target[0]=t,this.onChange()}set y(t){this._target[1]=t,this.onChange()}set z(t){this._target[2]=t,this.onChange()}set w(t){this._target[3]=t,this.onChange()}identity(){return Me(this._target),this.onChange(),this}set(t,i,s,r){return t.length?this.copy(t):(Re(this._target,t,i,s,r),this.onChange(),this)}rotateX(t){return Te(this._target,this._target,t),this.onChange(),this}rotateY(t){return Se(this._target,this._target,t),this.onChange(),this}rotateZ(t){return Ce(this._target,this._target,t),this.onChange(),this}inverse(t=this._target){return Oe(this._target,t),this.onChange(),this}conjugate(t=this._target){return Ne(this._target,t),this.onChange(),this}copy(t){return Le(this._target,t),this.onChange(),this}normalize(t=this._target){return ke(this._target,t),this.onChange(),this}multiply(t,i){return i?zt(this._target,t,i):zt(this._target,this._target,t),this.onChange(),this}dot(t){return Ie(this._target,t)}fromMatrix3(t){return ze(this._target,t),this.onChange(),this}fromEuler(t,i){return Fe(this._target,t,t.order),i||this.onChange(),this}fromAxisAngle(t,i){return ve(this._target,t,i),this.onChange(),this}slerp(t,i){return De(this._target,this._target,t,i),this.onChange(),this}fromArray(t,i=0){return this._target[0]=t[i],this._target[1]=t[i+1],this._target[2]=t[i+2],this._target[3]=t[i+3],this.onChange(),this}toArray(t=[],i=0){return t[i]=this[0],t[i+1]=this[1],t[i+2]=this[2],t[i+3]=this[3],t}}const $e=1e-6;function qe(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Pe(e,t,i,s,r,n,a,h,l,o,c,u,f,d,p,_,y){return e[0]=t,e[1]=i,e[2]=s,e[3]=r,e[4]=n,e[5]=a,e[6]=h,e[7]=l,e[8]=o,e[9]=c,e[10]=u,e[11]=f,e[12]=d,e[13]=p,e[14]=_,e[15]=y,e}function Ve(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ue(e,t){let i=t[0],s=t[1],r=t[2],n=t[3],a=t[4],h=t[5],l=t[6],o=t[7],c=t[8],u=t[9],f=t[10],d=t[11],p=t[12],_=t[13],y=t[14],E=t[15],O=i*h-s*a,M=i*l-r*a,S=i*o-n*a,C=s*l-r*h,m=s*o-n*h,x=r*o-n*l,v=c*_-u*p,T=c*y-f*p,g=c*E-d*p,A=u*y-f*_,b=u*E-d*_,D=f*E-d*y,w=O*D-M*b+S*A+C*g-m*T+x*v;return w?(w=1/w,e[0]=(h*D-l*b+o*A)*w,e[1]=(r*b-s*D-n*A)*w,e[2]=(_*x-y*m+E*C)*w,e[3]=(f*m-u*x-d*C)*w,e[4]=(l*g-a*D-o*T)*w,e[5]=(i*D-r*g+n*T)*w,e[6]=(y*S-p*x-E*M)*w,e[7]=(c*x-f*S+d*M)*w,e[8]=(a*b-h*g+o*v)*w,e[9]=(s*g-i*b-n*v)*w,e[10]=(p*m-_*S+E*O)*w,e[11]=(u*S-c*m-d*O)*w,e[12]=(h*T-a*A-l*v)*w,e[13]=(i*A-s*T+r*v)*w,e[14]=(_*M-p*C-y*O)*w,e[15]=(c*C-u*M+f*O)*w,e):null}function qt(e){let t=e[0],i=e[1],s=e[2],r=e[3],n=e[4],a=e[5],h=e[6],l=e[7],o=e[8],c=e[9],u=e[10],f=e[11],d=e[12],p=e[13],_=e[14],y=e[15],E=t*a-i*n,O=t*h-s*n,M=t*l-r*n,S=i*h-s*a,C=i*l-r*a,m=s*l-r*h,x=o*p-c*d,v=o*_-u*d,T=o*y-f*d,g=c*_-u*p,A=c*y-f*p,b=u*y-f*_;return E*b-O*A+M*g+S*T-C*v+m*x}function Ft(e,t,i){let s=t[0],r=t[1],n=t[2],a=t[3],h=t[4],l=t[5],o=t[6],c=t[7],u=t[8],f=t[9],d=t[10],p=t[11],_=t[12],y=t[13],E=t[14],O=t[15],M=i[0],S=i[1],C=i[2],m=i[3];return e[0]=M*s+S*h+C*u+m*_,e[1]=M*r+S*l+C*f+m*y,e[2]=M*n+S*o+C*d+m*E,e[3]=M*a+S*c+C*p+m*O,M=i[4],S=i[5],C=i[6],m=i[7],e[4]=M*s+S*h+C*u+m*_,e[5]=M*r+S*l+C*f+m*y,e[6]=M*n+S*o+C*d+m*E,e[7]=M*a+S*c+C*p+m*O,M=i[8],S=i[9],C=i[10],m=i[11],e[8]=M*s+S*h+C*u+m*_,e[9]=M*r+S*l+C*f+m*y,e[10]=M*n+S*o+C*d+m*E,e[11]=M*a+S*c+C*p+m*O,M=i[12],S=i[13],C=i[14],m=i[15],e[12]=M*s+S*h+C*u+m*_,e[13]=M*r+S*l+C*f+m*y,e[14]=M*n+S*o+C*d+m*E,e[15]=M*a+S*c+C*p+m*O,e}function We(e,t,i){let s=i[0],r=i[1],n=i[2],a,h,l,o,c,u,f,d,p,_,y,E;return t===e?(e[12]=t[0]*s+t[4]*r+t[8]*n+t[12],e[13]=t[1]*s+t[5]*r+t[9]*n+t[13],e[14]=t[2]*s+t[6]*r+t[10]*n+t[14],e[15]=t[3]*s+t[7]*r+t[11]*n+t[15]):(a=t[0],h=t[1],l=t[2],o=t[3],c=t[4],u=t[5],f=t[6],d=t[7],p=t[8],_=t[9],y=t[10],E=t[11],e[0]=a,e[1]=h,e[2]=l,e[3]=o,e[4]=c,e[5]=u,e[6]=f,e[7]=d,e[8]=p,e[9]=_,e[10]=y,e[11]=E,e[12]=a*s+c*r+p*n+t[12],e[13]=h*s+u*r+_*n+t[13],e[14]=l*s+f*r+y*n+t[14],e[15]=o*s+d*r+E*n+t[15]),e}function Ye(e,t,i){let s=i[0],r=i[1],n=i[2];return e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e[3]=t[3]*s,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*n,e[9]=t[9]*n,e[10]=t[10]*n,e[11]=t[11]*n,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Xe(e,t,i,s){let r=s[0],n=s[1],a=s[2],h=Math.hypot(r,n,a),l,o,c,u,f,d,p,_,y,E,O,M,S,C,m,x,v,T,g,A,b,D,w,z;return Math.abs(h)<$e?null:(h=1/h,r*=h,n*=h,a*=h,l=Math.sin(i),o=Math.cos(i),c=1-o,u=t[0],f=t[1],d=t[2],p=t[3],_=t[4],y=t[5],E=t[6],O=t[7],M=t[8],S=t[9],C=t[10],m=t[11],x=r*r*c+o,v=n*r*c+a*l,T=a*r*c-n*l,g=r*n*c-a*l,A=n*n*c+o,b=a*n*c+r*l,D=r*a*c+n*l,w=n*a*c-r*l,z=a*a*c+o,e[0]=u*x+_*v+M*T,e[1]=f*x+y*v+S*T,e[2]=d*x+E*v+C*T,e[3]=p*x+O*v+m*T,e[4]=u*g+_*A+M*b,e[5]=f*g+y*A+S*b,e[6]=d*g+E*A+C*b,e[7]=p*g+O*A+m*b,e[8]=u*D+_*w+M*z,e[9]=f*D+y*w+S*z,e[10]=d*D+E*w+C*z,e[11]=p*D+O*w+m*z,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function Ke(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function Pt(e,t){let i=t[0],s=t[1],r=t[2],n=t[4],a=t[5],h=t[6],l=t[8],o=t[9],c=t[10];return e[0]=Math.hypot(i,s,r),e[1]=Math.hypot(n,a,h),e[2]=Math.hypot(l,o,c),e}function Ge(e){let t=e[0],i=e[1],s=e[2],r=e[4],n=e[5],a=e[6],h=e[8],l=e[9],o=e[10];const c=t*t+i*i+s*s,u=r*r+n*n+a*a,f=h*h+l*l+o*o;return Math.sqrt(Math.max(c,u,f))}const Vt=function(){const e=[1,1,1];return function(t,i){let s=e;Pt(s,i);let r=1/s[0],n=1/s[1],a=1/s[2],h=i[0]*r,l=i[1]*n,o=i[2]*a,c=i[4]*r,u=i[5]*n,f=i[6]*a,d=i[8]*r,p=i[9]*n,_=i[10]*a,y=h+u+_,E=0;return y>0?(E=Math.sqrt(y+1)*2,t[3]=.25*E,t[0]=(f-p)/E,t[1]=(d-o)/E,t[2]=(l-c)/E):h>u&&h>_?(E=Math.sqrt(1+h-u-_)*2,t[3]=(f-p)/E,t[0]=.25*E,t[1]=(l+c)/E,t[2]=(d+o)/E):u>_?(E=Math.sqrt(1+u-h-_)*2,t[3]=(d-o)/E,t[0]=(l+c)/E,t[1]=.25*E,t[2]=(f+p)/E):(E=Math.sqrt(1+_-h-u)*2,t[3]=(l-c)/E,t[0]=(d+o)/E,t[1]=(f+p)/E,t[2]=.25*E),t}}();function Qe(e,t,i,s){let r=U([e[0],e[1],e[2]]);const n=U([e[4],e[5],e[6]]),a=U([e[8],e[9],e[10]]);qt(e)<0&&(r=-r),i[0]=e[12],i[1]=e[13],i[2]=e[14];const l=e.slice(),o=1/r,c=1/n,u=1/a;l[0]*=o,l[1]*=o,l[2]*=o,l[4]*=c,l[5]*=c,l[6]*=c,l[8]*=u,l[9]*=u,l[10]*=u,Vt(t,l),s[0]=r,s[1]=n,s[2]=a}function je(e,t,i,s){const r=e,n=t[0],a=t[1],h=t[2],l=t[3],o=n+n,c=a+a,u=h+h,f=n*o,d=n*c,p=n*u,_=a*c,y=a*u,E=h*u,O=l*o,M=l*c,S=l*u,C=s[0],m=s[1],x=s[2];return r[0]=(1-(_+E))*C,r[1]=(d+S)*C,r[2]=(p-M)*C,r[3]=0,r[4]=(d-S)*m,r[5]=(1-(f+E))*m,r[6]=(y+O)*m,r[7]=0,r[8]=(p+M)*x,r[9]=(y-O)*x,r[10]=(1-(f+_))*x,r[11]=0,r[12]=i[0],r[13]=i[1],r[14]=i[2],r[15]=1,r}function Ze(e,t){let i=t[0],s=t[1],r=t[2],n=t[3],a=i+i,h=s+s,l=r+r,o=i*a,c=s*a,u=s*h,f=r*a,d=r*h,p=r*l,_=n*a,y=n*h,E=n*l;return e[0]=1-u-p,e[1]=c+E,e[2]=f-y,e[3]=0,e[4]=c-E,e[5]=1-o-p,e[6]=d+_,e[7]=0,e[8]=f+y,e[9]=d-_,e[10]=1-o-u,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function He(e,t,i,s,r){let n=1/Math.tan(t/2),a=1/(s-r);return e[0]=n/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(r+s)*a,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*r*s*a,e[15]=0,e}function Je(e,t,i,s,r,n,a){let h=1/(t-i),l=1/(s-r),o=1/(n-a);return e[0]=-2*h,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*o,e[11]=0,e[12]=(t+i)*h,e[13]=(r+s)*l,e[14]=(a+n)*o,e[15]=1,e}function ti(e,t,i,s){let r=t[0],n=t[1],a=t[2],h=s[0],l=s[1],o=s[2],c=r-i[0],u=n-i[1],f=a-i[2],d=c*c+u*u+f*f;d===0?f=1:(d=1/Math.sqrt(d),c*=d,u*=d,f*=d);let p=l*f-o*u,_=o*c-h*f,y=h*u-l*c;return d=p*p+_*_+y*y,d===0&&(o?h+=1e-6:l?o+=1e-6:l+=1e-6,p=l*f-o*u,_=o*c-h*f,y=h*u-l*c,d=p*p+_*_+y*y),d=1/Math.sqrt(d),p*=d,_*=d,y*=d,e[0]=p,e[1]=_,e[2]=y,e[3]=0,e[4]=u*y-f*_,e[5]=f*p-c*y,e[6]=c*_-u*p,e[7]=0,e[8]=c,e[9]=u,e[10]=f,e[11]=0,e[12]=r,e[13]=n,e[14]=a,e[15]=1,e}function Lt(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e[4]=t[4]+i[4],e[5]=t[5]+i[5],e[6]=t[6]+i[6],e[7]=t[7]+i[7],e[8]=t[8]+i[8],e[9]=t[9]+i[9],e[10]=t[10]+i[10],e[11]=t[11]+i[11],e[12]=t[12]+i[12],e[13]=t[13]+i[13],e[14]=t[14]+i[14],e[15]=t[15]+i[15],e}function Rt(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e[4]=t[4]-i[4],e[5]=t[5]-i[5],e[6]=t[6]-i[6],e[7]=t[7]-i[7],e[8]=t[8]-i[8],e[9]=t[9]-i[9],e[10]=t[10]-i[10],e[11]=t[11]-i[11],e[12]=t[12]-i[12],e[13]=t[13]-i[13],e[14]=t[14]-i[14],e[15]=t[15]-i[15],e}function ei(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*i,e[9]=t[9]*i,e[10]=t[10]*i,e[11]=t[11]*i,e[12]=t[12]*i,e[13]=t[13]*i,e[14]=t[14]*i,e[15]=t[15]*i,e}class K extends Array{constructor(t=1,i=0,s=0,r=0,n=0,a=1,h=0,l=0,o=0,c=0,u=1,f=0,d=0,p=0,_=0,y=1){return super(t,i,s,r,n,a,h,l,o,c,u,f,d,p,_,y),this}get x(){return this[12]}get y(){return this[13]}get z(){return this[14]}get w(){return this[15]}set x(t){this[12]=t}set y(t){this[13]=t}set z(t){this[14]=t}set w(t){this[15]=t}set(t,i,s,r,n,a,h,l,o,c,u,f,d,p,_,y){return t.length?this.copy(t):(Pe(this,t,i,s,r,n,a,h,l,o,c,u,f,d,p,_,y),this)}translate(t,i=this){return We(this,i,t),this}rotate(t,i,s=this){return Xe(this,s,t,i),this}scale(t,i=this){return Ye(this,i,typeof t=="number"?[t,t,t]:t),this}add(t,i){return i?Lt(this,t,i):Lt(this,this,t),this}sub(t,i){return i?Rt(this,t,i):Rt(this,this,t),this}multiply(t,i){return t.length?i?Ft(this,t,i):Ft(this,this,t):ei(this,this,t),this}identity(){return Ve(this),this}copy(t){return qe(this,t),this}fromPerspective({fov:t,aspect:i,near:s,far:r}={}){return He(this,t,i,s,r),this}fromOrthogonal({left:t,right:i,bottom:s,top:r,near:n,far:a}){return Je(this,t,i,s,r,n,a),this}fromQuaternion(t){return Ze(this,t),this}setPosition(t){return this.x=t[0],this.y=t[1],this.z=t[2],this}inverse(t=this){return Ue(this,t),this}compose(t,i,s){return je(this,t,i,s),this}decompose(t,i,s){return Qe(this,t,i,s),this}getRotation(t){return Vt(t,this),this}getTranslation(t){return Ke(t,this),this}getScaling(t){return Pt(t,this),this}getMaxScaleOnAxis(){return Ge(this)}lookAt(t,i,s){return ti(this,t,i,s),this}determinant(){return qt(this)}fromArray(t,i=0){return this[0]=t[i],this[1]=t[i+1],this[2]=t[i+2],this[3]=t[i+3],this[4]=t[i+4],this[5]=t[i+5],this[6]=t[i+6],this[7]=t[i+7],this[8]=t[i+8],this[9]=t[i+9],this[10]=t[i+10],this[11]=t[i+11],this[12]=t[i+12],this[13]=t[i+13],this[14]=t[i+14],this[15]=t[i+15],this}toArray(t=[],i=0){return t[i]=this[0],t[i+1]=this[1],t[i+2]=this[2],t[i+3]=this[3],t[i+4]=this[4],t[i+5]=this[5],t[i+6]=this[6],t[i+7]=this[7],t[i+8]=this[8],t[i+9]=this[9],t[i+10]=this[10],t[i+11]=this[11],t[i+12]=this[12],t[i+13]=this[13],t[i+14]=this[14],t[i+15]=this[15],t}}function ii(e,t,i="YXZ"){return i==="XYZ"?(e[1]=Math.asin(Math.min(Math.max(t[8],-1),1)),Math.abs(t[8])<.99999?(e[0]=Math.atan2(-t[9],t[10]),e[2]=Math.atan2(-t[4],t[0])):(e[0]=Math.atan2(t[6],t[5]),e[2]=0)):i==="YXZ"?(e[0]=Math.asin(-Math.min(Math.max(t[9],-1),1)),Math.abs(t[9])<.99999?(e[1]=Math.atan2(t[8],t[10]),e[2]=Math.atan2(t[1],t[5])):(e[1]=Math.atan2(-t[2],t[0]),e[2]=0)):i==="ZXY"?(e[0]=Math.asin(Math.min(Math.max(t[6],-1),1)),Math.abs(t[6])<.99999?(e[1]=Math.atan2(-t[2],t[10]),e[2]=Math.atan2(-t[4],t[5])):(e[1]=0,e[2]=Math.atan2(t[1],t[0]))):i==="ZYX"?(e[1]=Math.asin(-Math.min(Math.max(t[2],-1),1)),Math.abs(t[2])<.99999?(e[0]=Math.atan2(t[6],t[10]),e[2]=Math.atan2(t[1],t[0])):(e[0]=0,e[2]=Math.atan2(-t[4],t[5]))):i==="YZX"?(e[2]=Math.asin(Math.min(Math.max(t[1],-1),1)),Math.abs(t[1])<.99999?(e[0]=Math.atan2(-t[9],t[5]),e[1]=Math.atan2(-t[2],t[0])):(e[0]=0,e[1]=Math.atan2(t[8],t[10]))):i==="XZY"&&(e[2]=Math.asin(-Math.min(Math.max(t[4],-1),1)),Math.abs(t[4])<.99999?(e[0]=Math.atan2(t[6],t[5]),e[1]=Math.atan2(t[8],t[0])):(e[0]=Math.atan2(-t[9],t[10]),e[1]=0)),e}const It=new K;class si extends Array{constructor(t=0,i=t,s=t,r="YXZ"){super(t,i,s),this.order=r,this.onChange=()=>{},this._target=this;const n=["0","1","2"];return new Proxy(this,{set(a,h){const l=Reflect.set(...arguments);return l&&n.includes(h)&&a.onChange(),l}})}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}set x(t){this._target[0]=t,this.onChange()}set y(t){this._target[1]=t,this.onChange()}set z(t){this._target[2]=t,this.onChange()}set(t,i=t,s=t){return t.length?this.copy(t):(this._target[0]=t,this._target[1]=i,this._target[2]=s,this.onChange(),this)}copy(t){return this._target[0]=t[0],this._target[1]=t[1],this._target[2]=t[2],this.onChange(),this}reorder(t){return this._target.order=t,this.onChange(),this}fromRotationMatrix(t,i=this.order){return ii(this._target,t,i),this.onChange(),this}fromQuaternion(t,i=this.order,s){return It.fromQuaternion(t),this._target.fromRotationMatrix(It,i),s||this.onChange(),this}fromArray(t,i=0){return this._target[0]=t[i],this._target[1]=t[i+1],this._target[2]=t[i+2],this}toArray(t=[],i=0){return t[i]=this[0],t[i+1]=this[1],t[i+2]=this[2],t}}class ri{constructor(){this.parent=null,this.children=[],this.visible=!0,this.matrix=new K,this.worldMatrix=new K,this.matrixAutoUpdate=!0,this.worldMatrixNeedsUpdate=!1,this.position=new B,this.quaternion=new Be,this.scale=new B(1),this.rotation=new si,this.up=new B(0,1,0),this.rotation._target.onChange=()=>this.quaternion.fromEuler(this.rotation,!0),this.quaternion._target.onChange=()=>this.rotation.fromQuaternion(this.quaternion,void 0,!0)}setParent(t,i=!0){this.parent&&t!==this.parent&&this.parent.removeChild(this,!1),this.parent=t,i&&t&&t.addChild(this,!1)}addChild(t,i=!0){~this.children.indexOf(t)||this.children.push(t),i&&t.setParent(this,!1)}removeChild(t,i=!0){~this.children.indexOf(t)&&this.children.splice(this.children.indexOf(t),1),i&&t.setParent(null,!1)}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.worldMatrixNeedsUpdate||t)&&(this.parent===null?this.worldMatrix.copy(this.matrix):this.worldMatrix.multiply(this.parent.worldMatrix,this.matrix),this.worldMatrixNeedsUpdate=!1,t=!0);for(let i=0,s=this.children.length;i<s;i++)this.children[i].updateMatrixWorld(t)}updateMatrix(){this.matrix.compose(this.quaternion,this.position,this.scale),this.worldMatrixNeedsUpdate=!0}traverse(t){if(!t(this))for(let i=0,s=this.children.length;i<s;i++)this.children[i].traverse(t)}decompose(){this.matrix.decompose(this.quaternion._target,this.position,this.scale),this.rotation.fromQuaternion(this.quaternion)}lookAt(t,i=!1){i?this.matrix.lookAt(this.position,t,this.up):this.matrix.lookAt(t,this.position,this.up),this.matrix.getRotation(this.quaternion._target),this.rotation.fromQuaternion(this.quaternion)}}function ni(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function ai(e,t){let i=t[0],s=t[1],r=t[2],n=t[3],a=i+i,h=s+s,l=r+r,o=i*a,c=s*a,u=s*h,f=r*a,d=r*h,p=r*l,_=n*a,y=n*h,E=n*l;return e[0]=1-u-p,e[3]=c-E,e[6]=f+y,e[1]=c+E,e[4]=1-o-p,e[7]=d-_,e[2]=f-y,e[5]=d+_,e[8]=1-o-u,e}function hi(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function li(e,t,i,s,r,n,a,h,l,o){return e[0]=t,e[1]=i,e[2]=s,e[3]=r,e[4]=n,e[5]=a,e[6]=h,e[7]=l,e[8]=o,e}function oi(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function ci(e,t){let i=t[0],s=t[1],r=t[2],n=t[3],a=t[4],h=t[5],l=t[6],o=t[7],c=t[8],u=c*a-h*o,f=-c*n+h*l,d=o*n-a*l,p=i*u+s*f+r*d;return p?(p=1/p,e[0]=u*p,e[1]=(-c*s+r*o)*p,e[2]=(h*s-r*a)*p,e[3]=f*p,e[4]=(c*i-r*l)*p,e[5]=(-h*i+r*n)*p,e[6]=d*p,e[7]=(-o*i+s*l)*p,e[8]=(a*i-s*n)*p,e):null}function kt(e,t,i){let s=t[0],r=t[1],n=t[2],a=t[3],h=t[4],l=t[5],o=t[6],c=t[7],u=t[8],f=i[0],d=i[1],p=i[2],_=i[3],y=i[4],E=i[5],O=i[6],M=i[7],S=i[8];return e[0]=f*s+d*a+p*o,e[1]=f*r+d*h+p*c,e[2]=f*n+d*l+p*u,e[3]=_*s+y*a+E*o,e[4]=_*r+y*h+E*c,e[5]=_*n+y*l+E*u,e[6]=O*s+M*a+S*o,e[7]=O*r+M*h+S*c,e[8]=O*n+M*l+S*u,e}function fi(e,t,i){let s=t[0],r=t[1],n=t[2],a=t[3],h=t[4],l=t[5],o=t[6],c=t[7],u=t[8],f=i[0],d=i[1];return e[0]=s,e[1]=r,e[2]=n,e[3]=a,e[4]=h,e[5]=l,e[6]=f*s+d*a+o,e[7]=f*r+d*h+c,e[8]=f*n+d*l+u,e}function di(e,t,i){let s=t[0],r=t[1],n=t[2],a=t[3],h=t[4],l=t[5],o=t[6],c=t[7],u=t[8],f=Math.sin(i),d=Math.cos(i);return e[0]=d*s+f*a,e[1]=d*r+f*h,e[2]=d*n+f*l,e[3]=d*a-f*s,e[4]=d*h-f*r,e[5]=d*l-f*n,e[6]=o,e[7]=c,e[8]=u,e}function ui(e,t,i){let s=i[0],r=i[1];return e[0]=s*t[0],e[1]=s*t[1],e[2]=s*t[2],e[3]=r*t[3],e[4]=r*t[4],e[5]=r*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function gi(e,t){let i=t[0],s=t[1],r=t[2],n=t[3],a=t[4],h=t[5],l=t[6],o=t[7],c=t[8],u=t[9],f=t[10],d=t[11],p=t[12],_=t[13],y=t[14],E=t[15],O=i*h-s*a,M=i*l-r*a,S=i*o-n*a,C=s*l-r*h,m=s*o-n*h,x=r*o-n*l,v=c*_-u*p,T=c*y-f*p,g=c*E-d*p,A=u*y-f*_,b=u*E-d*_,D=f*E-d*y,w=O*D-M*b+S*A+C*g-m*T+x*v;return w?(w=1/w,e[0]=(h*D-l*b+o*A)*w,e[1]=(l*g-a*D-o*T)*w,e[2]=(a*b-h*g+o*v)*w,e[3]=(r*b-s*D-n*A)*w,e[4]=(i*D-r*g+n*T)*w,e[5]=(s*g-i*b-n*v)*w,e[6]=(_*x-y*m+E*C)*w,e[7]=(y*S-p*x-E*M)*w,e[8]=(p*m-_*S+E*O)*w,e):null}class pi extends Array{constructor(t=1,i=0,s=0,r=0,n=1,a=0,h=0,l=0,o=1){return super(t,i,s,r,n,a,h,l,o),this}set(t,i,s,r,n,a,h,l,o){return t.length?this.copy(t):(li(this,t,i,s,r,n,a,h,l,o),this)}translate(t,i=this){return fi(this,i,t),this}rotate(t,i=this){return di(this,i,t),this}scale(t,i=this){return ui(this,i,t),this}multiply(t,i){return i?kt(this,t,i):kt(this,this,t),this}identity(){return oi(this),this}copy(t){return hi(this,t),this}fromMatrix4(t){return ni(this,t),this}fromQuaternion(t){return ai(this,t),this}fromBasis(t,i,s){return this.set(t[0],t[1],t[2],i[0],i[1],i[2],s[0],s[1],s[2]),this}inverse(t=this){return ci(this,t),this}getNormalMatrix(t){return gi(this,t),this}}let mi=0;class _i extends ri{constructor(t,{geometry:i,program:s,mode:r=t.TRIANGLES,frustumCulled:n=!0,renderOrder:a=0}={}){super(),t.canvas||console.error("gl not passed as first argument to Mesh"),this.gl=t,this.id=mi++,this.geometry=i,this.program=s,this.mode=r,this.frustumCulled=n,this.renderOrder=a,this.modelViewMatrix=new K,this.normalMatrix=new pi,this.beforeRenderCallbacks=[],this.afterRenderCallbacks=[]}onBeforeRender(t){return this.beforeRenderCallbacks.push(t),this}onAfterRender(t){return this.afterRenderCallbacks.push(t),this}draw({camera:t}={}){t&&(this.program.uniforms.modelMatrix||Object.assign(this.program.uniforms,{modelMatrix:{value:null},viewMatrix:{value:null},modelViewMatrix:{value:null},normalMatrix:{value:null},projectionMatrix:{value:null},cameraPosition:{value:null}}),this.program.uniforms.projectionMatrix.value=t.projectionMatrix,this.program.uniforms.cameraPosition.value=t.worldPosition,this.program.uniforms.viewMatrix.value=t.viewMatrix,this.modelViewMatrix.multiply(t.viewMatrix,this.worldMatrix),this.normalMatrix.getNormalMatrix(this.modelViewMatrix),this.program.uniforms.modelMatrix.value=this.worldMatrix,this.program.uniforms.modelViewMatrix.value=this.modelViewMatrix,this.program.uniforms.normalMatrix.value=this.normalMatrix),this.beforeRenderCallbacks.forEach(s=>s&&s({mesh:this,camera:t}));let i=this.program.cullFace&&this.worldMatrix.determinant()<0;this.program.use({flipFaces:i}),this.geometry.draw({mode:this.mode,program:this.program}),this.afterRenderCallbacks.forEach(s=>s&&s({mesh:this,camera:t}))}}if(window.innerHeight<window.innerWidth){let n=function(a){requestAnimationFrame(n),s.uniforms.uTime.value=a*.001,e.render({scene:r})};const e=new Ee({alpha:!0,width:window.innerWidth/2,height:window.innerHeight*2/2}),t=e.gl;document.body.appendChild(t.canvas),t.canvas.style.position="absolute",t.canvas.style.top="0",t.canvas.style.left="0",t.canvas.style.width="100%",t.canvas.style.height="200vh",t.canvas.style.display="block",t.canvas.style.zIndex=-100,t.canvas.style.imageRendering="pixelated",t.clearColor(0,0,0,0);const i=new de(t,{position:{size:2,data:new Float32Array([-1,-1,3,-1,-1,3])},uv:{size:2,data:new Float32Array([0,0,2,0,0,2])}}),s=new ge(t,{vertex:`
            attribute vec2 uv;
            attribute vec2 position;

            varying vec2 vUv;

            void main() {
                vUv = uv;
                gl_Position = vec4(position, 0, 1);
            }
        `,fragment:`
            precision highp float;

            uniform float uTime;
            uniform float resx;
            uniform float resy;
            varying vec2 vUv;

            float smin2( float a, float b, float k )
            {
                k *= 6.0;
                float h = max( k-abs(a-b), 0.0 )/k;
                return min(a,b) - h*h*h*k*(1.0/6.0);
            }

            float domain(vec3 v, float t) {
                vec2 torus = vec2(8.0, 3.0);
                vec2 q = vec2(length(v.xz+vec2(0.0, -2.4))-torus.x,v.y);
                float b = length(q)-torus.y;
                
                float size=3.0;
                
                vec3 sv = size*(v);
                
                float g= abs(cos(sv.x)+cos(sv.y+uTime)+cos(sv.z))-0.6;
                return -smin2(-b,-g/(2.0*size), 0.04);
            }

            vec3 grad (vec3 v) {
                float e = 0.0001;
                float local = domain(v,uTime);
                vec3 g = vec3(
                    (domain(vec3(v.x+e,v.yz),uTime)-local)/(1.0*e),
                    (domain(vec3(v.x,v.y+e,v.z),uTime)-local)/(1.0*e),
                    (domain(vec3(v.xy,v.z+e),uTime)-local)/(1.0*e)
                );
                return g;
            }
            void main() {
                vec2 uv = (2.0*vUv-vec2(1.0)) *3.0 * normalize(vec2(resx, resy));
                vec3 dir = normalize(vec3(uv.x, 4.0, uv.y));
                gl_FragColor.rgba = vec4(vec3(1.0), 1.0);
                
                const int MAX_STEPS = 100;
                vec3 loc = vec3(0.0, -14.0, 0.0);
                float dist = 0.0;
                float current_sign = sign(domain(loc, uTime));

                for(int i = 0; i < MAX_STEPS; i++){
                    if (sign(domain(loc,uTime)) != current_sign) {
                        break;
                    } 
                    dist += abs(domain(loc,uTime));
                    loc = loc + dir*abs(domain(loc,uTime));
                }
                vec3 v_normal = grad(loc);
                vec3 v_position = loc;
                v_normal = v_normal.xzy;
                v_normal.z = -v_normal.z;

                gl_FragColor.w *= exp(-0.0001*pow(dist, 1.6))/1.5;
                gl_FragColor.xyz *= 0.4*normalize(v_normal) ;
                gl_FragColor.xyz += 0.3;
                gl_FragColor.xyz = vec3(length(gl_FragColor.xyz));
                gl_FragColor.w *= 0.8;
            }
        `,uniforms:{uTime:{value:0},resx:{value:window.innerWidth},resy:{value:window.innerHeight*2}},transparent:!0}),r=new _i(t,{geometry:i,program:s});requestAnimationFrame(n)}
